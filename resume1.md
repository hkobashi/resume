### プロジェクト概要
- 自社の営業が顧客やビジネスパートナーとファイルや契約書を  
連携するためのファイル共有サービス。（Webアプリ）  
※ストレージにはBOXAPIを使用

### 使用技術
- `利用言語`：
  Python3.9(サーバー側), Javascript(フロントエンド側), MySQL(8.0)
- `フレームワーク`：
  Django, jQuery
- `インフラ`：
  AWS(<br>
  EC2, RDS(MySQL), ELB(ALB), S3, CloudFront, Route53,  
  CodePipeline, CodeBuild, CodeDeploy,  
  IAM,  WAF, GuardDuty, SecurityHub, Inspector, VPC FlowLogs,  
  Config, X-Ray ,SSM,  
  Chatbot  
)

### チーム情報
- PdM 1名、PL 1名、開発者3名、インフラ1名  
→インフラ設計・構築、開発およびテストを担当

### 担当業務
- `インフラ（AWS）構築`
  ※上記「使用技術」で使用しているAWSサービスは全て自分で設定・構築している
- `単体テストの作成（unittest）`
  関係者以外がファイルに対して閲覧や操作ができないこと（権限周りの確認）などをテストした。<br>
  また、新規にバグなどが出た際は随時テストを作成していた。  
  →開発初期段階で仕様変更が頻繁にしていたのでまずは「既存機能を破壊していないか」のテストを  
  作成してCIに乗せることで毎度手動で確認する状況を解消した。  
- `セキュリティ対策`（  
  APサーバーの脆弱性および不正アクティビティを検知するための設定  
  SQLインジェクションやXSSを防ぐためのWAF設置、  
）  
  →ターゲットは企業（toB）のサービスなのでセキュリティインシデントによる  
  信頼の失墜を回避するため
- `CI/CD構築`（  
  GitHubへのPushを起点にCodeBuildによるCI（現時点では単体テストのみ）を設定、  
  ※CodeBuildにてカバレッジを表示できるように設定している  
  前段のCIをパスしたらCodeDeployによるCDを実行、  
  ※本番（商用）環境についてはPdM、PLによる承認プロセスを追加  
  ChatbotでCI/CDの結果をSlackで通知するよう設定  
)  
→手動による人的ミスを排除し、機能開発や企画を考える時間を増やす仕組みを作るため
- `プロジェクトCRUD機能の実装`

### どんな課題があったのか
- `書類や提案資料の作成・精査といった本来営業が注力したい業務に時間を割くことができないこと。`  
  ＜背景＞  
  今日、自社の営業は顧客と受託やSESの契約を行うのに必要な契約書等の書類をやりとりするのに  
  メールを使って書類等のファイルを送受信していた。  
  そのため過去やりとりした書類等を見返すとなった際にメールや自社で使用している  
  共有ドライブ（GoogleDrive）から探してローカルにダウンロードする必要があった。  
  運用として「やりとりした書類等は共有ドライブに格納する」というルールがあったが、  
  人によっては共有ドライブに書類等を配置することを忘れてしまうこともあるため、  
  「書類等を探す」ことに時間がかかることが多かった。

### どうやって課題を解決したのか
- 自社のファイル共有プラットフォームを持つことでメールによるファイルのやりとりをする必要がなくなった。  
  顧客に書類等のファイルをリンクで共有・閲覧できるため従来の運用である  
  「メール等で受け取ったファイルを共有ドライブに格納する」必要がなくなった。  
  副次的ではあるが、他のチームメンバーに書類等を連携する際もリンクでやりとりすることで  
  「双方で同じものを見ることができているか」の確認が容易になるという効果もあった。

### 工夫した点
- `開発における単体テストやデプロイの自動化を実現した。`（受託含む自社プロジェクトで前例なし）  
  ※単体テストにunittest(Python)、自動化にAWS（CodeBuild, CodeDeploy, CodePipeline）を使用  
  デプロイ頻度を月/10回程度→月/23回程度に向上させ、単体テスト、デプロイに関する手作業の工数を0にした。  
  ※デプロイ方式にはBlue/Greenデプロイを採用しているためシステムのダウンタイムを最小化している。  
  本プロジェクトにて自動デプロイを実装して以降さまざまなプロジェクトで導入してほしいと言われ好評だった。  
  ※現在、Seleniumを使った結合テストを実装中・・・
- `サーバー構築の自動化（オートスケーリング）`
  ミドルウェアなど必要な環境を構築するスクリプトを作成して  
  userdata（EC2起動時実行スクリプト）を使って環境構築を自動化した。  
  ※本プロジェクトで作成したuserdataはさまざまなプロジェクトで使用、改良されている。
- `アプリ使用状況の可視化`
  AWS  X-Rayを使って「どの機能が使われているか、使われていないか」を数値化した。  
  X-Rayで取得したデータを元に機能改修を行い、アクセス数を機能改修前と比べて13％向上させた  
- `開発環境およびAWS環境のコンテナ化`
  ＜ローカル環境＞<br>
  後から参画するメンバーがローカル開発環境の構築に手間取ることが増えていたため、<br>
  ローカル開発用および本番とほぼ同等のコンテナ環境（docker-compose）を構築した。<br>
  自分含めた初期開発メンバーは全員Windowsだったが、参画したメンバーの中にはMacを<br>
  使用して開発するメンバーもいたため、予め作成していた環境構築手順が機能せずプロジェクト参画が滞ってしまっていた。<br>
  そのため、OSによる環境構築手順の差異を排除するために開発環境をコンテナ化させた。<br>
  ※必要コマンド（docker-compose up -dなど）はREADME.mdにまとめている<br>
  ＜AWS環境＞<br>
  前段の「サーバー構築の自動化」にて構築したEC2環境をコンテナに移行した。（ECS on Fargate）<br>
  ※例外として「python manage.py migrate」などdb操作を実行するためのEC2環境が1台存在する<br>
  商用環境以外（開発者/ステージング環境）についてはFargate Spotを使用することでコストを最適化した。<br>
  EC2環境にてオーバースペック気味のサーバーを冗長化して構築していたことをあり、最終的にAWS料金を30％削減することができた。<br>
- `AWS環境のコード化（IaC）`
  AWS CDK（Python）を用いてインフラ（EC2,ECS,RDS）、CI/CDパイプライン、WAFをコード化することでインフラの再現性を実現した。<br>
  ※これらのコードは今後の新規プロジェクトで流用される予定