### プロジェクト概要
- 行政システムリプレース

### 使用技術
- 利用言語：Perl(サーバー側), Javascript(フロントエンド側), MySQL(8.0)
- フレームワーク：ActivePerl
- インフラ：WebArena(CentOS6)

### チーム情報
- PL 1名、開発者3名、インフラ1名
→インフラ構築を担当

### 担当業務
- リプレース先OSの選定
- SSL証明書の更新<br>
  顧客が購入・管理しているSSL証明書（EV証明書）の取得、更新を実施した。<br>
  →顧客側でSSL証明書を更新できる人材がいなかったため
- AWSを使っての検証環境構築およびCD実装<br>
  GitHubへのPushを起点に所定のサーバーに自動でデプロイされるよう設定。<br>
  →既存環境への影響の回避、手動作業の最小化のため
- システムリプレース<br>
  OS：CentOS6→RockyLinux8<br>
  Web:Apache2.4.12→Apache2.4.54<br>
  DB：MySQL5.6→MySQL8.0<br>

### どんな課題があったのか
- 顧客が使用しているWebアプリケーションで使用しているOSやミドルウェアの<br>
  バージョンが古くアップデートされていないためセキュリティの観点で懸念があった。<br>
  OSについてはアップグレード（CentOS6→7）したとしてもすぐに公式サポートが<br>
  切れてしまうためOSを切り替えることになった。<br>
  ※CentOS6はすでに公式サポートが切れている<br>
  リプレース先の候補はRHELやAlmaLinux、UbuntuなどがあったがCentOSと100％の互換性があるという<br>
  RockyLinuxを使って現行システムをリプレースすることにした。

### どうやって課題を解決したのか
- パッケージ更新をスクリプト化した。（cronで年4回実施するよう設定）<br>
  ミドルウェアなどの設定ファイルはS3に格納しているため<br>
  いつでも参照、設定の再現ができるようにした。

### 工夫した点
- 環境構築スクリプトの作成<br>
  サーバーの仕組みがブラックボックス化していたため当時の構築手順書やパラメーターシートが存在しなかったため、<br>
  サーバーを構築するためのスクリプトを作成することで設定を確認する際は<br>
  当スクリプトを確認すれば良い状況を作った。
- 重要情報の秘匿化<br>
  前項のスクリプトで編集する必要があるApacheやMySQLなどの<br>
  固有設定ファイルについてはS3にファイルを格納して<br>
  パスワードやドメイン管理者情報など重要な情報をAWS SSMのParameter Storeを使って秘匿化した。<br>
  ※アクセスキーを使用しているが権限の最小化、アクセスキー使用元IPアドレスの制限は実施済み
- DNSフェールオーバーの設定<br>
  SSL証明書更新やシステムリプレース時にWebサイトの表示ができなくなってしまい顧客と作業タイミングを<br>
  調整することが手間になっていたため現行サーバーとは別にリプレース先サーバーを作成して<br>
  現行サーバーをプライマリ、リプレース先サーバーをセカンダリに設定することで<br>
  Webサイトが表示できなくなる時間を最小化した。